!function(){var a=Ember.get,b=Ember.set;Ember.Location.registerImplementation("hashbang",Ember.HashLocation.extend({getURL:function(){return a(this,"location").hash.substr(2)},setURL:function(c){a(this,"location").hash="!"+c,b(this,"lastSetURL","!"+c)},onUpdateURL:function(c){var d=this,e=Ember.guidFor(this);Ember.$(window).bind("hashchange.ember-location-"+e,function(){Ember.run(function(){var e=location.hash.substr(2);a(d,"lastSetURL")!==e&&(b(d,"lastSetURL",null),c(location.hash.substr(2)))})})},formatURL:function(a){return"#!"+a}}))}();var App=App||Ember.Application.create();App.Router.reopen({location:"hashbang"}),App.Router.map(function(){this.resource("posts",function(){this.route("detail",{path:"/:post_id"}),this.route("edit",{path:"/edit/:post_id"}),this.route("new",{path:"/new"})})}),App.PostsRoute=Ember.Route.extend({model:function(){return $.getJSON("/api/posts")},actions:{updatePosts:function(){var a=this;this.model().done(function(b){a.get("controller").set("model",b)})}}}),App.PostsController=Ember.ArrayController.extend({actions:{deletePost:function(a){var b=this;$.ajax({url:"/api/posts/"+a.id,type:"DELETE"}).done(function(){b.send("updatePosts"),b.transitionToRoute("posts")})}}}),App.PostsDetailRoute=Ember.Route.extend({model:function(a){var b=this.modelFor("posts"),c=_.find(b,function(b){return b.id==a.post_id});return c}}),App.PostsEditRoute=Ember.Route.extend({model:function(a){var b=this.modelFor("posts"),c=_.find(b,function(b){return b.id==a.post_id});return c}}),App.PostsNewController=Ember.Controller.extend({actions:{addPost:function(){var a=this,b={id:this.get("id"),title:this.get("title"),author:this.get("author"),contents:this.get("contents")};$.ajax({type:"POST",url:"/api/posts",data:b}).done(function(){a.send("updatePosts"),a.transitionToRoute("posts")})}}}),App.PostsEditController=Ember.ObjectController.extend({actions:{editPost:function(){var a=this,b={id:this.get("id"),title:this.get("title"),author:this.get("author"),contents:this.get("contents")};$.ajax({type:"PUT",url:"/api/posts/"+this.get("id"),data:b}).done(function(){a.transitionToRoute("posts.detail",b)})}}}),Ember.Handlebars.helper("markdown",function(a){return a?new Handlebars.SafeString(markdown.toHTML(a)):""});